(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0ecd6f27"],{"3d68":function(e,t,n){"use strict";var i=n("d2e9"),s=n.n(i);s.a},"5cbe":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"subjectiveWork"},[n("classroom-header",{attrs:{header:e.headers,jump:e.jump}}),n("div",{staticClass:"subjectiveContent"},[n("swiper",{ref:"mySwiper",attrs:{options:e.swiperOption}},e._l(e.homeworkSubjectiveQs,function(t,i){return e.pageShow?n("swiper-slide",{key:i},[n("scroll-content",{ref:"myscrollfull",refInFor:!0,attrs:{mescrollValue:e.mescrollValue}},[n("div",{staticClass:"subjective_warp"},[n("div",{staticClass:"subjective"},[n("div",{staticClass:"Collection",on:{click:function(n){e.Collection(t.questionId)}}},[n("img",{attrs:{src:e.Collectionsrc,alt:""}})]),n("div",{staticClass:"centertext"},[e._v("左右滑动切换题目")]),n("div",{staticClass:"topic_warp",attrs:{id:"qc"+t.questionId}},[n("div",{staticClass:"title"},[e._v("主观题-"+e._s(i+1)+" "),t.questionTypeInCN?n("span",[e._v("("+e._s(t.questionTypeInCN)+")")]):e._e()]),n("div",{staticClass:"topic",attrs:{id:"tp"+t.questionId},domProps:{innerHTML:e._s(t.questionContent)}},[e._v("\n                                    "+e._s(t.questionContent)+"\n                                ")])]),n("PopupPic",{attrs:{questionPic:t.questionPic}}),e.homeworkCompleted?n("div",{staticClass:"anwers"},[e._v("\n                                此题答案为:"),n("span",{domProps:{innerHTML:e._s(t.answer)}})]):e._e(),e.homeworkCompleted?n("div",{staticClass:"remind",domProps:{innerHTML:e._s(t.parse)}}):e._e()],1),!e.homeworkCompleted&&e.subjectiveAnswer[i].show?n("div",{staticClass:"button_warp"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!e.subjectiveAnswer[i].answer,expression:"!subjectiveAnswer[index].answer"}],staticClass:"subjective_submit Answerstart",on:{click:function(n){e.answerQuestions(t.questionId,t.questionContent,t.questionPic)}}}),n("div",{directives:[{name:"show",rawName:"v-show",value:e.subjectiveAnswer[i].answer,expression:"subjectiveAnswer[index].answer"}],staticClass:"subjective_submit Answermodify",on:{click:function(n){e.modifyAnswer(t.questionId,t.questionContent,t.questionPic)}}})]):e._e(),n("board",{directives:[{name:"show",rawName:"v-show",value:e.subjectiveAnswer[i].answer,expression:"subjectiveAnswer[index].answer"}],attrs:{subjectiveAnswer:e.subjectiveAnswer,id:t.questionId}})],1)])],1):e._e()}))],1),e.textmessage?n("div",{staticClass:"textmessage"},[e._v("\n        此习题没有主观题\n    ")]):e._e(),e.loading?n("loading"):e._e()],1)},s=[],o=(n("a481"),n("20d6"),n("96cf"),n("1da1")),a=n("be94"),r=(n("5fc6"),n("5af2")),c=n.n(r),u=(n("ceaa"),n("b2fb")),d=n.n(u),l=(n("ac6a"),n("cadf"),n("551c"),n("097d"),n("d67f")),v=n("b5a9"),w=n("8c36"),m=n("15d6"),b=n("2f62"),p=n("4360"),h=n("399a"),g=n("f0be"),f=n("a07d"),j=n("951f"),C=n.n(j),A=null,I={components:{classroomHeader:l["a"],board:v["a"],Loading:w["a"],PopupPic:f["a"],ScrollContent:m["a"]},data:function(){return{textmessage:!1,objectiveAnswerbtn:!1,loading:!0,pageShow:!1,headers:{title:"",url:"/studentIndex"},jump:{name:"转至客观题",url:"/objectiveWork"},mescrollValue:{up:!1,down:!1},Collectionsrc:n("f2f6"),Collectiontype:!1,swiperOption:{notNextTick:!0,loop:!1,initialSlide:0,speed:800,direction:"horizontal",on:{slideChange:function(){A.initCollection(this.realIndex)}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},subjectiveId:"",subjectiveAnswer:[],ready:!1,cameraOptions:{quality:100,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.CAMERA,allowEdit:!0,encodingType:Camera.EncodingType.PNG,targetWidth:586,targetHeight:700,mediaType:0,cameraDirection:0,saveToPhotoAlbum:!0}}},watch:{boardImg:function(e){var t=this,n=this;n.subjectiveAnswer.forEach(function(i,s){i.id===n.subjectiveId&&(i.answer=e.data,t.$set(n.subjectiveAnswer,s,i))}),d.a.open({text:"答案提交中...",spinnerType:"fading-circle"}),Object(g["f"])(e.data).then(function(e){c()({message:"图片存储成功！",position:"middle",duration:1e3});var t=e.data.data;Object(g["g"])(n.homeworkId,n.subjectiveId,t).then(function(e){console.log(e),c()({message:"答案提交成功！",position:"middle",duration:1e3}),d.a.close()}).catch(function(e){c()({message:"答案提交失败！",position:"middle",duration:1e3}),d.a.close(),console.log(e)})}).catch(function(e){c()({message:"图片存储失败！",position:"middle",duration:1e3}),console.log(e)})}},computed:Object(a["a"])({swiper:function(){return this.$refs.mySwiper.swiper}},Object(b["b"])(["isBoard","isBlueTooth","boardImg","homeworkId","homeworkName","homeworkCompleted","homeworkSubjectiveQs"])),created:function(){A=this},mounted:function(){this.initialize(),this.getSubjectiveWork()},methods:{initialize:function(){var e=this;document.addEventListener("deviceready",e.onDeviceReady.bind(this),!1)},onDeviceReady:function(){this.ready=!0},getSubjectiveWork:function(){this.headers.title=this.homeworkName;for(var e=0;e<this.homeworkSubjectiveQs.length;e++)this.subjectiveAnswer.push({id:this.homeworkSubjectiveQs[e].questionId,answer:"",show:!1});this.subjectiveAnswer.length>0?(this.initCollection(0),this.pageShow=!0,this.loading=!1,this.textmessage=!1,this.initImgs()):(this.pageShow=!0,this.loading=!1,this.textmessage=!0)},initImgs:function(){for(var e=0;e<this.homeworkSubjectiveQs.length;e++)this.getSubjectiveImg(this.homeworkSubjectiveQs[e])},getSubjectiveImg:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,s,o,a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=this,!(t&&t.answerModelForStudent||t.answerModelForTeacher)){e.next=9;break}return e.next=4,Object(g["d"])(t.answerModelForTeacher?t.answerModelForTeacher.stubForSubjective:t.answerModelForStudent.stubForSubjective);case 4:i=e.sent,s=n.subjectiveAnswer.findIndex(function(e){return e.id===t.questionId}),-1!=s&&(o=n.subjectiveAnswer[s],i.data.data&&(o.answer=i.data.data.content,o.show=!0,n.$set(n.subjectiveAnswer,s,o))),e.next=11;break;case 9:a=n.subjectiveAnswer.findIndex(function(e){return e.id===t.questionId}),-1!=a&&(r=n.subjectiveAnswer[a],r.show=!0,n.$set(n.subjectiveAnswer,a,r));case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),answerQuestions:function(e,t,n){if(this.ready){var i=this;i.subjectiveId=e,navigator.camera.getPicture(function(e){var t=i.subjectiveAnswer.findIndex(function(e){return e.id===i.subjectiveId});if(console.log(t),-1!=t){var n=i.subjectiveAnswer[t];n.answer=e,i.$set(i.subjectiveAnswer,t,n),i.sumbitSubjectPic(e)}},function(e){c()("拍照失败，原因为："+e)},i.cameraOptions)}else c()("设备没响应，请稍后重试")},sumbitSubjectPic:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return d.a.open({text:"正在提交主观题答案...",spinnerType:"fading-circle"}),e.next=3,Object(g["f"])(t).then(function(e){c()({message:"图片存储成功！",position:"middle",duration:1e3});var t=e.data.data;Object(g["g"])(n.homeworkId,n.subjectiveId,t).then(function(e){console.log(e),c()({message:"答案提交成功！",position:"middle",duration:1e3}),d.a.close()}).catch(function(e){c()({message:"答案提交失败！",position:"middle",duration:1e3}),d.a.close(),console.log(e)})}).catch(function(e){c()({message:"图片存储失败！",position:"middle",duration:1e3}),d.a.close(),console.log(e)});case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),answerQuestions1:function(e,t,n){if(!this.objectiveAnswerbtn){this.objectiveAnswerbtn=!0;var i=this;document.getElementById("tp"+e).setAttribute("style","letter-spacing: 4px !important;padding-top: 8px !important"),C()(document.getElementById("tp"+e),{useCORS:!0,logging:!1,ignoreElements:function(e){var t=e.type;return!(!t||"text"!==t)&&(console.log(e),!0)}}).then(function(t){var s=t.toDataURL("image/png").replace("data:image/png;base64,","");document.getElementById("tp"+e).setAttribute("style",'letter-spacing:"";padding-top: ""'),i.subjectiveId=e,window.HandwrittenBoard.isConnect(function(e){console.log(e)},function(e){switch(console.log(e),e.data.status){case 0:localStorage.getItem("bluetooth")||p["a"].commit("SET_BLUETOOTH",!0),window.HandwrittenBoard.exploration(),console.log("第一个"),i.objectiveAnswerbtn=!1;break;case 2:var t={content:s,pic:n,base64img:""};window.HandwrittenBoard.getBase64img(t),console.log("第二个"),i.objectiveAnswerbtn=!1;break;default:break}})})}},modifyAnswer:function(e,t,n){if(this.ready){var i=this;i.subjectiveId=e,navigator.camera.getPicture(function(e){var t=i.subjectiveAnswer.findIndex(function(e){return e.id===i.subjectiveId});if(console.log(t),-1!=t){var n=i.subjectiveAnswer[t];n.answer=e,i.$set(i.subjectiveAnswer,t,n),i.sumbitSubjectPic(e)}},function(e){c()("拍照失败，原因为："+e)},i.cameraOptions)}else c()("设备没响应，请稍后重试")},modifyAnswer1:function(e,t,n){var i=this;if(!this.objectiveAnswerbtn){this.objectiveAnswerbtn=!0;var s=this;document.getElementById("tp"+e).setAttribute("style","letter-spacing: 4px !important;padding-top: 8px !important"),C()(document.getElementById("tp"+e),{useCORS:!0,logging:!1,ignoreElements:function(e){var t=e.type;return!(!t||"text"!==t)&&(console.log(e),!0)}}).then(function(t){var o=t.toDataURL("image/png").replace("data:image/png;base64,","");document.getElementById("tp"+e).setAttribute("style",'letter-spacing:"";padding-top: ""'),s.subjectiveId=e;for(var a="",r=0;r<i.subjectiveAnswer.length;r++)e===i.subjectiveAnswer[r].id&&(a=i.subjectiveAnswer[r].answer);window.HandwrittenBoard.isConnect(function(e){console.log(e)},function(e){switch(console.log(e),e.data.status){case 0:localStorage.getItem("bluetooth")||p["a"].commit("SET_BLUETOOTH",!0),window.HandwrittenBoard.exploration(),console.log("第一个"),s.objectiveAnswerbtn=!1;break;case 2:var t={content:o,pic:n,base64img:a};window.HandwrittenBoard.getBase64img(t),console.log("第二个"),s.objectiveAnswerbtn=!1;break;default:break}})})}},Collection:function(e){var t=this,i=this;this.Collectiontype?Object(h["l"])(e).then(function(s){if("0010"===s.data.code){t.Collectiontype=!1,t.Collectionsrc=n("f2f6");for(var o=0;o<i.homeworkSubjectiveQs.length;o++)if(i.homeworkSubjectiveQs[o].questionId===e){i.homeworkSubjectiveQs[o].favor=!1,p["a"].commit("SET_HOMEWORKSUBJECTIVEQS",i.homeworkSubjectiveQs);break}}else c()({message:s.data.msg,position:"middle",duration:1e3})}):Object(h["a"])(e).then(function(s){if("0010"===s.data.code){t.Collectiontype=!0,t.Collectionsrc=n("6921");for(var o=0;o<i.homeworkSubjectiveQs.length;o++)if(i.homeworkSubjectiveQs[o].questionId===e){i.homeworkSubjectiveQs[o].favor=!0,p["a"].commit("SET_HOMEWORKSUBJECTIVEQS",i.homeworkSubjectiveQs);break}}else c()({message:s.data.msg,position:"middle",duration:1e3})})},initCollection:function(e){this.homeworkSubjectiveQs[e].favor?this.Collectionsrc=n("6921"):this.Collectionsrc=n("f2f6")}}},k=I,S=(n("3d68"),n("2877")),y=Object(S["a"])(k,i,s,!1,null,"61999c5d",null);y.options.__file="show-subjective.vue";t["default"]=y.exports},d2e9:function(e,t,n){}}]);