(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55a59a96"],{bd26:function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"testsubjective"},[s("classroom-header",{attrs:{header:e.headers,jump:e.jump}}),s("div",{staticClass:"subjectiveContent"},[s("swiper",{ref:"mySwiper",attrs:{options:e.swiperOption}},e._l(e.testSubjectiveQs,function(t,n){return e.pageShow?s("swiper-slide",{key:n},[s("scroll-content",{ref:"myscrollfull",refInFor:!0,attrs:{mescrollValue:e.mescrollValue}},[s("div",{staticClass:"subjective_warp"},[s("div",{staticClass:"subjective"},[s("div",{staticClass:"Collection",on:{click:function(s){e.Collection(t.questionId)}}},[s("img",{attrs:{src:e.Collectionsrc,alt:""}})]),s("div",{staticClass:"centertext"},[e._v("左右滑动切换题目")]),s("div",{staticClass:"topic_warp",attrs:{id:"qc"+t.questionId}},[s("div",{staticClass:"title"},[e._v("主观题-"+e._s(n+1)+" "),t.questionTypeInCN?s("span",[e._v("("+e._s(t.questionTypeInCN)+")")]):e._e()]),s("div",{staticClass:"topic",attrs:{id:"tp"+t.questionId},domProps:{innerHTML:e._s(t.questionContent)}},[e._v("\n                                    "+e._s(t.questionContent)+"\n                                ")])]),s("PopupPic",{attrs:{questionPic:t.questionPic}}),e.testCompleted?s("div",{staticClass:"anwers"},[e._v("\n                                此题答案为:"),s("span",{domProps:{innerHTML:e._s(t.answer)}})]):e._e(),e.testCompleted?s("div",{staticClass:"remind",domProps:{innerHTML:e._s(t.parse)}}):e._e()],1),!e.testCompleted&&e.subjectiveAnswer[n].show?s("div",{staticClass:"button_warp"},[s("div",{directives:[{name:"show",rawName:"v-show",value:!e.subjectiveAnswer[n].answer,expression:"!subjectiveAnswer[index].answer"}],staticClass:"subjective_submit Answerstart",on:{click:function(s){e.answerQuestions(t.questionId,t.questionContent,t.questionPic)}}}),s("div",{directives:[{name:"show",rawName:"v-show",value:e.subjectiveAnswer[n].answer,expression:"subjectiveAnswer[index].answer"}],staticClass:"subjective_submit Answermodify",on:{click:function(s){e.modifyAnswer(t.questionId,t.questionContent,t.questionPic)}}})]):e._e(),s("board",{directives:[{name:"show",rawName:"v-show",value:e.subjectiveAnswer[n].answer,expression:"subjectiveAnswer[index].answer"}],attrs:{subjectiveAnswer:e.subjectiveAnswer,id:t.questionId}})],1)])],1):e._e()}))],1),e.textmessage?s("div",{staticClass:"textmessage"},[e._v("\n        此考试没有主观题\n    ")]):e._e(),e.loading?s("loading"):e._e()],1)},i=[],o=(s("a481"),s("20d6"),s("96cf"),s("1da1")),a=s("be94"),c=(s("5fc6"),s("5af2")),r=s.n(c),u=(s("ceaa"),s("b2fb")),l=s.n(u),d=(s("ac6a"),s("cadf"),s("551c"),s("097d"),s("d67f")),v=s("b5a9"),b=s("8c36"),p=s("15d6"),w=s("2f62"),m=s("4360"),g=s("399a"),f=s("b594"),h=s("a07d"),j=s("951f"),C=s.n(j),S=null,A={components:{classroomHeader:d["a"],board:v["a"],Loading:b["a"],PopupPic:h["a"],ScrollContent:p["a"]},data:function(){return{textmessage:!1,objectiveAnswerbtn:!1,loading:!0,pageShow:!1,headers:{title:"",url:"/testindex"},jump:{name:"转至客观题",url:"/tesobjective"},mescrollValue:{up:!1,down:!1},Collectionsrc:s("f2f6"),Collectiontype:!1,swiperOption:{notNextTick:!0,loop:!1,initialSlide:0,speed:800,direction:"horizontal",on:{slideChange:function(){S.initCollection(this.realIndex)}},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}},subjectiveId:"",subjectiveAnswer:[]}},watch:{boardImg:function(e){var t=this,s=this;s.subjectiveAnswer.forEach(function(n,i){n.id===s.subjectiveId&&(n.answer=e.data,t.$set(s.subjectiveAnswer,i,n))}),l.a.open({text:"答案提交中...",spinnerType:"fading-circle"}),Object(f["f"])(e.data).then(function(e){r()({message:"图片存储成功！",position:"middle",duration:1e3});var t=e.data.data;Object(f["g"])(s.testId,s.subjectiveId,t).then(function(e){console.log(e),r()({message:"答案提交成功！",position:"middle",duration:1e3}),l.a.close()}).catch(function(e){r()({message:"答案提交失败！",position:"middle",duration:1e3}),l.a.close(),console.log(e)})}).catch(function(e){r()({message:"图片存储失败！",position:"middle",duration:1e3}),console.log(e)})}},computed:Object(a["a"])({swiper:function(){return this.$refs.mySwiper.swiper}},Object(w["b"])(["isBoard","isBlueTooth","boardImg","testId","testName","testCompleted","testSubjectiveQs"])),created:function(){S=this},mounted:function(){this.gettestsubjective()},methods:{gettestsubjective:function(){this.headers.title=this.testName;for(var e=0;e<this.testSubjectiveQs.length;e++)this.subjectiveAnswer.push({id:this.testSubjectiveQs[e].questionId,answer:"",show:!1});this.subjectiveAnswer.length>0?(this.initCollection(0),this.pageShow=!0,this.loading=!1,this.textmessage=!1,this.initImgs()):(this.pageShow=!0,this.loading=!1,this.textmessage=!0)},initImgs:function(){for(var e=0;e<this.testSubjectiveQs.length;e++)this.getSubjectiveImg(this.testSubjectiveQs[e])},getSubjectiveImg:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var s,n,i,o,a,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(s=this,!(t&&t.answerModelForStudent||t.answerModelForTeacher)){e.next=9;break}return e.next=4,Object(f["a"])(t.answerModelForTeacher?t.answerModelForTeacher.stubForSubjective:t.answerModelForStudent.stubForSubjective);case 4:n=e.sent,i=s.subjectiveAnswer.findIndex(function(e){return e.id===t.questionId}),-1!=i&&(o=s.subjectiveAnswer[i],n.data.data&&(o.answer=n.data.data.content,o.show=!0,s.$set(s.subjectiveAnswer,i,o))),e.next=11;break;case 9:a=s.subjectiveAnswer.findIndex(function(e){return e.id===t.questionId}),-1!=a&&(c=s.subjectiveAnswer[a],c.show=!0,s.$set(s.subjectiveAnswer,a,c));case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),answerQuestions:function(e,t,s){if(!this.objectiveAnswerbtn){this.objectiveAnswerbtn=!0;var n=this;document.getElementById("tp"+e).setAttribute("style","letter-spacing: 4px !important;padding-top: 8px !important"),C()(document.getElementById("tp"+e),{useCORS:!0,logging:!1,ignoreElements:function(e){var t=e.type;return!(!t||"text"!==t)&&(console.log(e),!0)}}).then(function(t){var i=t.toDataURL("image/png").replace("data:image/png;base64,","");document.getElementById("tp"+e).setAttribute("style",'letter-spacing:"";padding-top: ""'),n.subjectiveId=e,window.HandwrittenBoard.isConnect(function(e){console.log(e)},function(e){switch(console.log(e),e.data.status){case 0:localStorage.getItem("bluetooth")||m["a"].commit("SET_BLUETOOTH",!0),window.HandwrittenBoard.exploration(),console.log("第一个"),n.objectiveAnswerbtn=!1;break;case 2:var t={content:i,pic:s,base64img:""};window.HandwrittenBoard.getBase64img(t),console.log("第二个"),n.objectiveAnswerbtn=!1;break;default:break}})})}},modifyAnswer:function(e,t,s){var n=this;if(!this.objectiveAnswerbtn){this.objectiveAnswerbtn=!0;var i=this;document.getElementById("tp"+e).setAttribute("style","letter-spacing: 4px !important;padding-top: 8px !important"),C()(document.getElementById("tp"+e),{useCORS:!0,logging:!1,ignoreElements:function(e){var t=e.type;return!(!t||"text"!==t)&&(console.log(e),!0)}}).then(function(t){var o=t.toDataURL("image/png").replace("data:image/png;base64,","");document.getElementById("tp"+e).setAttribute("style",'letter-spacing:"";padding-top: ""'),i.subjectiveId=e;for(var a="",c=0;c<n.subjectiveAnswer.length;c++)e===n.subjectiveAnswer[c].id&&(a=n.subjectiveAnswer[c].answer);window.HandwrittenBoard.isConnect(function(e){console.log(e)},function(e){switch(console.log(e),e.data.status){case 0:localStorage.getItem("bluetooth")||m["a"].commit("SET_BLUETOOTH",!0),window.HandwrittenBoard.exploration(),console.log("第一个"),i.objectiveAnswerbtn=!1;break;case 2:var t={content:o,pic:s,base64img:a};window.HandwrittenBoard.getBase64img(t),console.log("第二个"),i.objectiveAnswerbtn=!1;break;default:break}})})}},Collection:function(e){var t=this,n=this;this.Collectiontype?Object(g["l"])(e).then(function(i){if("0010"===i.data.code){t.Collectiontype=!1,t.Collectionsrc=s("f2f6");for(var o=0;o<n.testSubjectiveQs.length;o++)if(n.testSubjectiveQs[o].questionId===e){n.testSubjectiveQs[o].favor=!1,m["a"].commit("SET_TESTSUBJECTIVEQS",n.testSubjectiveQs);break}}else r()({message:i.data.msg,position:"middle",duration:1e3})}):Object(g["a"])(e).then(function(i){if("0010"===i.data.code){t.Collectiontype=!0,t.Collectionsrc=s("6921");for(var o=0;o<n.testSubjectiveQs.length;o++)if(n.testSubjectiveQs[o].questionId===e){n.testSubjectiveQs[o].favor=!0,m["a"].commit("SET_TESTSUBJECTIVEQS",n.testSubjectiveQs);break}}else r()({message:i.data.msg,position:"middle",duration:1e3})})},initCollection:function(e){this.testSubjectiveQs[e].favor?this.Collectionsrc=s("6921"):this.Collectionsrc=s("f2f6")}}},I=A,x=(s("f435"),s("2877")),_=Object(x["a"])(I,n,i,!1,null,"17117f7e",null);_.options.__file="test-subjective.vue";t["default"]=_.exports},c85c:function(e,t,s){},f435:function(e,t,s){"use strict";var n=s("c85c"),i=s.n(n);i.a}}]);